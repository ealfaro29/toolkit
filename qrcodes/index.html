<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Code Generator</title>
    <link rel="icon" type="image/svg+xml" href="../favicon.svg" />
    <script>
        (function () {
            try {
                let theme = localStorage.getItem('creative-toolkit-theme') || 'system';
                if (theme === 'system') {
                    theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
                }
                document.documentElement.dataset.theme = theme;
            } catch (e) { }
        })();
    </script>
    <link rel="stylesheet" href="../shared/styles.css" />
    <style>
        /* === QRCODES-SPECIFIC STYLES === */

        /* Hide elements */
        .hidden {
            display: none !important;
        }

        /* Header grid positioning */
        header.panel {
            grid-column: 1 / -1;
        }

        /* Fix controls panel alignment */
        aside.panel.controls {
            position: relative;
            top: auto;
            align-self: stretch;
            height: 100%;
            max-height: calc(100vh - 140px);
            overflow-y: auto;
        }

        /* Canvas with grid background */
        main.panel.canvas {
            background-size: 40px 40px;
            background-image: linear-gradient(to right, var(--border-color) 1px, transparent 1px), linear-gradient(to bottom, var(--border-color) 1px, transparent 1px);
        }

        /* QR code container */
        #qrcode-container {
            width: 100%;
            max-width: 400px;
            aspect-ratio: 1 / 1;
            padding: var(--space-4);
            background-color: #fff;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
        }

        #qrcode {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #qrcode img,
        #qrcode canvas {
            max-width: 100%;
            max-height: 100%;
        }

        /* Wiki header background */
        .wiki-header {
            background-image: url('modal.png');
        }

        /* ----------------------------------------------------- */
        /*   iOS 26 LIQUID GLASS MIGRATION (from Sankey)   */
        /* ----------------------------------------------------- */

        /* Splash Screen Override - Liquid Glass */
        html[data-theme="light"] .splash-content,
        html[data-theme="light"] header.panel,
        html[data-theme="light"] aside.panel,
        html[data-theme="light"] .wiki-modal-content {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.75) 0%, rgba(255, 255, 255, 0.45) 100%);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            box-shadow:
                0 8px 32px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 0 rgba(255, 255, 255, 0.9),
                inset 0 0 20px rgba(255, 255, 255, 0.2);
        }

        html[data-theme="dark"] .splash-content,
        html[data-theme="dark"] header.panel,
        html[data-theme="dark"] aside.panel,
        html[data-theme="dark"] .wiki-modal-content {
            background: linear-gradient(145deg, rgba(30, 30, 40, 0.75) 0%, rgba(20, 20, 30, 0.45) 100%);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow:
                0 8px 32px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 0 rgba(255, 255, 255, 0.5),
                inset 0 0 20px rgba(255, 255, 255, 0.05);
        }

        /* Specific overrides for removing opaque backgrounds to allow glass */
        header.panel,
        aside.panel,
        .splash-image,
        .splash-info,
        .wiki-modal-content {
            background-color: transparent !important;
            border: none !important;
            box-shadow: none !important;
        }

        /* Header Background Image overlay */
        header.panel {
            position: relative;
            overflow: hidden;
        }

        header.panel::before {
            content: '';
            position: absolute;
            inset: 0;
            background: url('modal.png') center / cover no-repeat;
            opacity: 0.15;
            z-index: -1;
            pointer-events: none;
        }

        header.panel>* {
            position: relative;
            z-index: 1;
        }

        /* Splash Screen Layout */
        .splash-content {
            display: flex;
            width: 800px;
            max-width: 95vw;
            height: 480px;
            max-height: 90vh;
            padding: 16px;
            gap: 24px;
            overflow: hidden;
            border-radius: 40px;
        }

        .splash-image {
            flex: 1.2;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .splash-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 32px;
            opacity: 0.85;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .splash-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 12px;
        }

        .splash-info h2 {
            font-size: 32px;
            font-weight: 700;
            margin: 0 0 4px 0;
        }

        .version-badge {
            display: inline-flex;
            align-items: center;
            padding: 2px 8px;
            background: rgba(125, 125, 125, 0.15);
            border: 1px solid rgba(125, 125, 125, 0.2);
            border-radius: 100px;
            font-size: 13px;
            font-weight: 600;
            width: fit-content;
        }

        .splash-info .description {
            font-size: 16px;
            opacity: 0.8;
            line-height: 1.6;
            margin-top: 16px;
        }

        .features {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 24px;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 15px;
            font-weight: 500;
        }

        .feature-item span.emoji {
            font-size: 20px;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
        }

        .footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
            opacity: 0.8;
            margin-top: auto;
        }
    </style>
</head>

<body>
    <div class="splash-overlay" id="splash-screen">
        <div class="splash-content">
            <!-- Close button -->
            <button id="splash-close-btn" title="Close">Ã—</button>

            <!-- Left side: Visual showcase -->
            <div class="splash-image">
                <img src="modal.png" alt="QR Code Generator" draggable="false">
            </div>

            <!-- Right side: Info panel -->
            <div class="splash-info">
                <div>
                    <!-- Title and version -->
                    <div>
                        <h2>QR Code Generator</h2>
                    </div>

                    <!-- Description -->
                    <p class="description">
                        Create custom QR codes for URLs, WiFi, contacts, and more. Generate locally and download
                        instantly.
                    </p>

                    <!-- Features list -->
                    <div class="features">
                        <div class="feature-item">
                            <span class="emoji">ðŸ“±</span>
                            Multiple QR Types
                        </div>
                        <div class="feature-item">
                            <span class="emoji">ðŸ”’</span>
                            100% Client-Side
                        </div>
                        <div class="feature-item">
                            <span class="emoji">ðŸ“¥</span>
                            Instant Download
                        </div>
                    </div>
                </div>

                <!-- Footer with checkbox and credits -->
                <div class="footer">
                    <label>
                        <input type="checkbox" id="splash-dont-show-checkbox">
                        Don't show again
                    </label>
                    <div class="version-badge" style="font-size: 9px; padding: 2px 8px; border-width: 1px;">V 1.0.0
                    </div>
                    <span class="credits">2025 Â· VGTools</span>
                </div>
            </div>
        </div>
    </div>

    <div class="container loading" id="app-container">
        <header class="panel">
            <a href="../index.html" class="back-to-home" title="Return to Home">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" />
                </svg>
            </a>
            <h1>QR Code Generator</h1>
            <div class="sub">Create and download custom QR codes for any purpose.</div>
            <div class="theme-switcher">
                <button id="wiki-open-btn" title="Info">â“˜</button>
                <button id="theme-toggle" title="Change theme"></button>
            </div>
        </header>
        <aside class="panel controls">
            <div class="control-group">
                <button id="generate-btn" class="btn btn-secondary">Generate</button>
            </div>
            <div class="control-group">
                <div class="slider-row">
                    <label for="qr-type">QR Type</label>
                    <div class="select-wrapper">
                        <select id="qr-type" class="form-control">
                            <option value="url" selected>URL / Plain Text</option>
                            <option value="email">Email</option>
                            <option value="phone">Phone Number</option>
                            <option value="sms">SMS</option>
                            <option value="wifi">WiFi Network</option>
                            <option value="vcard">vCard (Contact)</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="control-group" style="flex-grow: 1; min-height: 0;">
                <div id="input-forms">
                    <div id="form-url">
                        <div class="form-group"><label for="url-text">Text or URL</label><textarea id="url-text"
                                class="form-control"
                                placeholder="e.g., https://www.example.com">https://www.brokenorbit.art</textarea></div>
                    </div>
                    <div id="form-email" class="hidden">
                        <div class="form-group"><label for="email-to">To</label><input type="email" id="email-to"
                                class="form-control" placeholder="recipient@example.com"></div>
                        <div class="form-group"><label for="email-subject">Subject</label><input type="text"
                                id="email-subject" class="form-control"></div>
                        <div class="form-group"><label for="email-body">Body</label><textarea id="email-body"
                                class="form-control"></textarea></div>
                    </div>
                    <div id="form-phone" class="hidden">
                        <div class="form-group"><label for="phone-number">Phone Number</label><input type="tel"
                                id="phone-number" class="form-control" placeholder="+15551234567"></div>
                    </div>
                    <div id="form-sms" class="hidden">
                        <div class="form-group"><label for="sms-number">Phone Number</label><input type="tel"
                                id="sms-number" class="form-control" placeholder="+15551234567"></div>
                        <div class="form-group"><label for="sms-message">Message</label><textarea id="sms-message"
                                class="form-control"></textarea></div>
                    </div>
                    <div id="form-wifi" class="hidden">
                        <div class="form-group"><label for="wifi-ssid">Network Name (SSID)</label><input type="text"
                                id="wifi-ssid" class="form-control"></div>
                        <div class="form-group"><label for="wifi-password">Password</label><input type="password"
                                id="wifi-password" class="form-control"></div>
                        <div class="form-group"><label for="wifi-encryption">Encryption</label>
                            <div class="select-wrapper"><select id="wifi-encryption" class="form-control">
                                    <option value="WPA" selected>WPA/WPA2</option>
                                    <option value="WEP">WEP</option>
                                    <option value="nopass">None</option>
                                </select></div>
                        </div>
                    </div>
                    <div id="form-vcard" class="hidden">
                        <div class="form-group"><label for="vcard-name">Full Name</label><input type="text"
                                id="vcard-name" class="form-control"></div>
                        <div class="form-group"><label for="vcard-phone">Phone Number</label><input type="tel"
                                id="vcard-phone" class="form-control"></div>
                        <div class="form-group"><label for="vcard-email">Email</label><input type="email"
                                id="vcard-email" class="form-control"></div>
                    </div>
                </div>
            </div>
            <div class="control-group"
                style="margin-top: auto; border-top: 1px solid var(--border-color); padding-top: var(--space-5);">
                <a id="download-link" class="btn btn-primary" disabled>Download</a>
            </div>
            <div class="note"> Tip: All QR codes are generated locally. No data is sent to any server. </div>
        </aside>
        <main class="panel canvas">
            <div id="qrcode-container" class="hidden">
                <div id="qrcode"></div>
            </div>
        </main>
    </div>

    <div id="wiki-overlay" class="popup-overlay"></div>
    <div id="dialog-overlay" class="popup-overlay">
        <div class="dialog-content panel">
            <p id="dialog-message"></p>
            <div id="dialog-actions" class="btn-group"></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/davidshimjs-qrcodejs@0.0.2/qrcode.min.js"></script>
    <script type="module">
        const WIKI_DATA = {
            "title": "QR Code Generator Info",
            "sections": [
                {
                    "title": "How to Use",
                    "content": [
                        "<b>1. Select QR Type:</b> Choose the type of content you want to encode from the dropdown menu (e.g., URL, WiFi, Contact).",
                        "<b>2. Fill in the Data:</b> Enter the required information in the form that appears.",
                        "<b>3. Generate:</b> Click the 'Generate' button to create the QR code.",
                        "<b>4. Download:</b> Once generated, click the 'Download' button to save the QR code as a PNG image."
                    ]
                },
                {
                    "title": "Features",
                    "content": [
                        "<b>Multiple Data Types:</b> Create codes for websites, contact cards (vCard), WiFi networks, emails, SMS, and phone numbers.",
                        "<b>Instant Preview:</b> See your QR code in the right-hand panel as soon as it's generated.",
                        "<b>Client-Side Generation:</b> For your privacy and security, all QR codes are created directly in your browser. No data is ever sent to a server."
                    ]
                }
            ]
        };

        const App = {
            el: {},
            state: {
                splashHidden: false,
                isWikiLoaded: false
            },
            qrInstance: null,
            THEMES: ['light', 'dark', 'system'],
            THEME_ICONS: { light: 'â˜€ï¸', dark: 'ðŸŒ”', system: 'âš™ï¸' },

            init() {
                this.cacheDOMElements();
                this.initTheme();
                this.checkSplashPreference();
                this.bindEvents();
                this.generateQRCode(); // Generate default on load
            },

            hideSplashScreen(dontShowAgain = false) {
                if (!this.state.splashHidden) {
                    this.state.splashHidden = true;
                    this.el.splashScreen.classList.add('hidden');
                    this.el.appContainer.classList.remove('loading');
                    if (dontShowAgain) {
                        localStorage.setItem('qrcodes-splash-hidden', 'true');
                    }
                }
            },

            checkSplashPreference() {
                if (localStorage.getItem('qrcodes-splash-hidden') === 'true') {
                    this.state.splashHidden = true;
                    this.el.splashScreen.classList.add('hidden');
                    this.el.appContainer.classList.remove('loading');
                }
            },

            cacheDOMElements() {
                const ids = [
                    'theme-toggle', 'wiki-open-btn', 'wiki-overlay', 'splash-screen',
                    'app-container', 'splash-close-btn', 'dialog-overlay',
                    'dialog-message', 'dialog-actions', 'qr-type', 'input-forms',
                    'generate-btn', 'qrcode-container', 'qrcode', 'download-link'
                ];
                document.querySelectorAll('#input-forms [id]').forEach(el => ids.push(el.id));
                ids.forEach(id => {
                    const key = id.replace(/-(\w)/g, (_, char) => char.toUpperCase());
                    this.el[key] = document.getElementById(id);
                });
            },

            bindEvents() {
                this.el.themeToggle.addEventListener('click', () => this.cycleTheme());
                this.el.wikiOpenBtn.addEventListener('click', () => this.openWiki());
                this.el.splashScreen.addEventListener('click', (e) => {
                    if (e.target === this.el.splashScreen) { const cb = document.getElementById('splash-dont-show-checkbox'); this.hideSplashScreen(cb?.checked || false); }
                });
                this.el.splashCloseBtn.addEventListener('click', () => { const cb = document.getElementById('splash-dont-show-checkbox'); this.hideSplashScreen(cb?.checked || false); });

                this.el.qrType.addEventListener('change', () => {
                    Array.from(this.el.inputForms.children).forEach(form => form.classList.add('hidden'));
                    this.el['form' + this.el.qrType.value.charAt(0).toUpperCase() + this.el.qrType.value.slice(1)].classList.remove('hidden');
                    this.disableDownloadLink();
                });
                this.el.inputForms.addEventListener('input', () => this.disableDownloadLink());
                this.el.generateBtn.addEventListener('click', () => this.generateQRCode());
            },

            showDialog(message, { buttons = [], onConfirm = () => { } } = {}) {
                this.el.dialogMessage.textContent = message;
                this.el.dialogActions.innerHTML = '';
                buttons.forEach(buttonInfo => {
                    const button = document.createElement('button');
                    button.className = `btn ${buttonInfo.class || 'btn-secondary'}`;
                    button.textContent = buttonInfo.text;
                    button.dataset.action = buttonInfo.action || 'cancel';
                    this.el.dialogActions.appendChild(button);
                });
                const actionHandler = (e) => {
                    if (e.target.dataset.action === 'confirm') onConfirm();
                    this.hideDialog();
                    this.el.dialogActions.removeEventListener('click', actionHandler);
                };
                this.el.dialogActions.addEventListener('click', actionHandler);
                this.el.dialogOverlay.classList.add('show');
            },
            hideDialog() { this.el.dialogOverlay.classList.remove('show'); },
            showAlert(message) {
                this.showDialog(message, { buttons: [{ text: 'OK', class: 'btn-primary', action: 'confirm' }] });
            },

            disableDownloadLink() {
                this.el.downloadLink.setAttribute('disabled', 'true');
                this.el.qrcodeContainer.classList.add('hidden');
            },

            getQRCodeData() {
                const type = this.el.qrType.value;
                let data = '';
                switch (type) {
                    case 'url': data = this.el.urlText.value; break;
                    case 'email':
                        data = `mailto:${this.el.emailTo.value}?subject=${encodeURIComponent(this.el.emailSubject.value)}&body=${encodeURIComponent(this.el.emailBody.value)}`;
                        break;
                    case 'phone': data = `tel:${this.el.phoneNumber.value}`; break;
                    case 'sms': data = `smsto:${this.el.smsNumber.value}:${encodeURIComponent(this.el.smsMessage.value)}`; break;
                    case 'wifi':
                        if (!this.el.wifiSsid.value) {
                            this.showAlert("Network Name (SSID) is required.");
                            return null;
                        }
                        data = `WIFI:T:${this.el.wifiEncryption.value};S:${this.el.wifiSsid.value};P:${this.el.wifiPassword.value};;`;
                        break;
                    case 'vcard':
                        data = `BEGIN:VCARD\nVERSION:3.0\nFN:${this.el.vcardName.value}\nTEL:${this.el.vcardPhone.value}\nEMAIL:${this.el.vcardEmail.value}\nEND:VCARD`;
                        break;
                }
                return data.trim();
            },

            generateQRCode() {
                const text = this.getQRCodeData();
                if (text === null) return;
                if (text === "") {
                    this.showAlert("Please fill in the details to generate a QR code.");
                    return;
                }

                this.el.qrcode.innerHTML = "";
                this.el.qrcodeContainer.classList.remove('hidden');

                this.qrInstance = new QRCode(this.el.qrcode, {
                    text: text,
                    width: 400,
                    height: 400,
                    colorDark: "#000000",
                    colorLight: "#ffffff",
                    correctLevel: QRCode.CorrectLevel.H
                });

                setTimeout(() => {
                    const canvas = this.el.qrcode.querySelector('canvas');
                    if (canvas) {
                        const margin = 20;
                        const newCanvas = document.createElement('canvas');
                        newCanvas.width = canvas.width + margin * 2;
                        newCanvas.height = canvas.height + margin * 2;
                        const ctx = newCanvas.getContext('2d');
                        ctx.fillStyle = '#ffffff';
                        ctx.fillRect(0, 0, newCanvas.width, newCanvas.height);
                        ctx.drawImage(canvas, margin, margin);

                        this.el.downloadLink.href = newCanvas.toDataURL('image/png');
                        this.el.downloadLink.download = 'qrcode.png';
                        this.el.downloadLink.removeAttribute('disabled');
                    }
                }, 100);
            },

            initTheme() {
                const savedTheme = localStorage.getItem('creative-toolkit-theme') || 'system';
                this.setTheme(savedTheme, false);
                window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
                    if (localStorage.getItem('creative-toolkit-theme') === 'system') this.applyTheme('system');
                });
            },
            setTheme(theme, save = true) {
                if (save) localStorage.setItem('creative-toolkit-theme', theme);
                this.el.themeToggle.textContent = this.THEME_ICONS[theme];
                this.applyTheme(theme);
            },
            cycleTheme() {
                const currentTheme = localStorage.getItem('creative-toolkit-theme') || 'system';
                this.setTheme(this.THEMES[(this.THEMES.indexOf(currentTheme) + 1) % this.THEMES.length]);
            },
            applyTheme(theme) {
                const isDark = (theme === 'system') ? window.matchMedia('(prefers-color-scheme: dark)').matches : theme === 'dark';
                document.documentElement.dataset.theme = isDark ? 'dark' : 'light';
            },
            openWiki() {
                if (!this.el.wikiOverlay.querySelector('.wiki-modal-content')) {
                    const wikiModal = document.createElement('div');
                    wikiModal.className = 'wiki-modal-content';
                    wikiModal.innerHTML = `<div class="wiki-header"><h3 id="wiki-title">Info</h3><button id="wiki-close-btn" title="Close">Ã—</button></div><div id="wiki-content"></div>`;
                    this.el.wikiOverlay.appendChild(wikiModal);
                    wikiModal.querySelector('#wiki-close-btn').addEventListener('click', () => this.closeWiki());
                }

                if (!this.isWikiLoaded) {
                    const titleEl = this.el.wikiOverlay.querySelector('#wiki-title');
                    const contentEl = this.el.wikiOverlay.querySelector('#wiki-content');
                    titleEl.textContent = WIKI_DATA.title;
                    const col1 = document.createElement('div'); col1.className = 'wiki-column';
                    const col2 = document.createElement('div'); col2.className = 'wiki-column';
                    WIKI_DATA.sections.forEach((s, index) => {
                        const sectionContainer = document.createElement('div');
                        const h4 = document.createElement('h4'); h4.textContent = s.title;
                        sectionContainer.appendChild(h4);
                        s.content.forEach(c => { const p = document.createElement('p'); p.innerHTML = c; sectionContainer.appendChild(p); });
                        if (index < Math.ceil(WIKI_DATA.sections.length / 2)) {
                            col1.appendChild(sectionContainer);
                        } else {
                            col2.appendChild(sectionContainer);
                        }
                    });
                    contentEl.innerHTML = '';
                    contentEl.appendChild(col1);
                    contentEl.appendChild(col2);
                    this.isWikiLoaded = true;
                }
                this.el.wikiOverlay.classList.add('show');
            },
            closeWiki() {
                this.el.wikiOverlay.classList.remove('show');
            }
        };

        document.addEventListener('DOMContentLoaded', () => App.init());
    </script>
    <a id="visitor-badge" class="visitor-badge" href="#" target="_blank" title="Visitors"></a>
    <script src="../shared/visitor-badge.js"></script>
</body>

</html>